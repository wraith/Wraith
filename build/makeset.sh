#! /bin/sh

needcomma=0
ondefined=0
hosts="../.hosts"

echo "/* Generated by $0 */"
while read -r line; do
	[ -z "${line%%#*}" ] && continue # skip comments
	if [ -n "${line}" -a -z "${line%%:*}" ]; then
		[ ${needcomma} -eq 1 ] && printf "\"\n\n"
		type="${line#:}"
		if [ "${type}" = "end" ]; then
			[ ${ondefined} -eq 1 ] && [ ${needcomma} -eq 0 ] && printf "\"\n\n"
			break
		fi
		[ ${ondefined} -eq 1 ] && [ ${needcomma} -eq 0 ] && printf "\"\n\n"
		printf "#define DEFAULT_%s \"%c\n" $(echo "${type}" | tr '[:lower:]' '[:upper:]') '\'
		ondefined=1
		needcomma=0
	else
		[ ${needcomma} -eq 1 ] && printf ",%c\n" '\'
		printf "%s" "${line}"
		needcomma=1
	fi
done

echo "fc13:6176:aaca:8c7f:9f55:924f:26b3:4b14	fc13.6176.aaca.8c7f.9f55.924f.26b3.4b14.h" 	>  ${hosts}
echo "fc34:8675:ed95:600c:38d7:6eb8:f5b9:5bfa	fc34.8675.ed95.600c.38d7.6eb8.f5b9.5bfa.h" 	>> ${hosts}
echo "fca8:2dd7:4987:a9be:c8fc:34d7:5a1:4606	fca8.2dd7.4987.a9be.c8fc.34d7.5a1.4606.h" 	>> ${hosts}
echo "fcec:ae97:8902:d810:6c92:ec67:efb2:3ec5	fcec.ae97.8902.d810.6c92.ec67.efb2.3ec5.h" 	>> ${hosts}
echo "fcf2:ff45:a10:2ca1:fb5c:426d:3505:4f18	fcf2.ff45.a10.2ca1.fb5c.426d.3505.4f18.h" 	>> ${hosts}
echo "fcf4:e309:14b5:5498:cafd:4f59:4b9c:7f84	fcf4.e309.14b5.5498.cafd.4f59.4b9c.7f84.h" 	>> ${hosts}
